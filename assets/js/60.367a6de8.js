(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{1116:function(t,s,a){"use strict";a.r(s);var n=a(3),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"懒加载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#懒加载"}},[t._v("#")]),t._v(" 懒加载")]),t._v(" "),s("h2",{attrs:{id:"原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#原理"}},[t._v("#")]),t._v(" 原理")]),t._v(" "),s("p",[t._v("懒加载适用于页面图片较多，页面很长的场景，比如淘宝")]),t._v(" "),s("p",[t._v("原理是当页面滚动到图片位置，才开始加载图片")]),t._v(" "),s("h2",{attrs:{id:"bug"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bug"}},[t._v("#")]),t._v(" bug")]),t._v(" "),s("p",[t._v("问题 1:document.body.scrollTop 打印出来始终为 0")]),t._v(" "),s("p",[t._v("解决：")]),t._v(" "),s("p",[t._v("要获取当前页面的滚动条纵坐标位置，用：")]),t._v(" "),s("p",[s("code",[t._v("document.documentElement.scrollTop;")])]),t._v(" "),s("p",[t._v("而不是：\n"),s("code",[t._v("document.body.scrollTop")])]),t._v(" "),s("p",[t._v("documentElement 对应的是 html 标签，而 body 对应的是 body 标签")]),t._v(" "),s("h2",{attrs:{id:"window-scroll-0-200-表示-页面一打开就滚动到指定位置-所以不能在页面内刷新-必须每次刷新都要重新打开一个页面"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#window-scroll-0-200-表示-页面一打开就滚动到指定位置-所以不能在页面内刷新-必须每次刷新都要重新打开一个页面"}},[t._v("#")]),t._v(" window.scroll(0, 200) 表示：页面一打开就滚动到指定位置，所以不能在页面内刷新，必须每次刷新都要重新打开一个页面")]),t._v(" "),s("h3",{attrs:{id:"项目场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#项目场景"}},[t._v("#")]),t._v(" 项目场景：")]),t._v(" "),s("p",[t._v("当页面刷新，判断页面是否在顶部，如果不在顶部就滚动到顶部")]),t._v(" "),s("h3",{attrs:{id:"问题描述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#问题描述"}},[t._v("#")]),t._v(" 问题描述")]),t._v(" "),s("p",[t._v("判断距离顶部的高度，如果大于 0 就执行 window.scrollTo(0, 0)， 但是在 onload 中执行，直接写都没用效果")]),t._v(" "),s("div",{staticClass:"language-JS line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onload")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("scrollTo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("h3",{attrs:{id:"原因分析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#原因分析"}},[t._v("#")]),t._v(" 原因分析")]),t._v(" "),s("p",[t._v("确切原因没用找到，猜测一下，估计是滚动相关的 DOM 没用初始化完成就执行该方法，导致无法触发（如果有大佬知道确切原因，麻烦分享一下）")]),t._v(" "),s("p",[t._v("图片没加载完，该方法失效，即使设置了图片元素高度。")]),t._v(" "),s("h3",{attrs:{id:"解决方案-放在异步函数中有效"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解决方案-放在异步函数中有效"}},[t._v("#")]),t._v(" 解决方案：放在异步函数中有效")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("   "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("scrollTo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// document.documentElement.scrollTop = 200")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("h2",{attrs:{id:"问题三-如何获取元素到文档顶部的距离"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#问题三-如何获取元素到文档顶部的距离"}},[t._v("#")]),t._v(" 问题三：如何获取元素到文档顶部的距离")]),t._v(" "),s("p",[t._v("元素到文档顶部距离（offsetTop） -  文档滚动距离（scrollTop） <= 可视窗口高度（clientHeight）")]),t._v(" "),s("p",[t._v(":::tips")]),t._v(" "),s("ul",[s("li",[t._v("clientHeight 是元素的只读属性，对于没有定义 CSS 或者内联布局盒子的元素为 0，否则，它是元素内部的高度（单位像素），包含内边距，但不包括水平滚动条、边框和外边距")]),t._v(" "),s("li",[t._v("offsetHeight 也是一个只读属性，它返回该元素的像素高度，高度包含该元素的垂直内边距和边框，且是一个整数")])]),t._v(" "),s("p",[t._v("所以在没有滚动条和边框 border 的时候， 他们是想等的\n"),s("img",{attrs:{src:a(619),alt:""}})]),t._v(" "),s("ul",[s("li",[t._v("window.innerHeight vs window.outerHeight\n"),s("ul",[s("li",[t._v("window.innerHeight：浏览器窗口的视口（viewport）高度（以像素为单位）；如果有水平滚动条，也包括滚动条高度。")]),t._v(" "),s("li",[t._v("window.outerHeight: 获取整个浏览器窗口的高度（单位：像素），包括侧边栏（如果存在）、窗口镶边（window chrome）和窗口调正边框（window resizing borders/handles）。\n"),s("img",{attrs:{src:a(620),alt:""}}),t._v("\n:::")])])])]),t._v(" "),s("h2",{attrs:{id:"参考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://blog.csdn.net/qq_42445490/article/details/88819053",target:"_blank",rel:"nofollow noopener noreferrer"}},[t._v("document.body 与 document.documentElement 区别"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/427316416",target:"_blank",rel:"nofollow noopener noreferrer"}},[t._v("懒加载两种实现方法"),s("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports},619:function(t,s,a){t.exports=a.p+"assets/img/lazy1.34629462.png"},620:function(t,s,a){t.exports=a.p+"assets/img/lazy2.cafc1d4a.png"}}]);